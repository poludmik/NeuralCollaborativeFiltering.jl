<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · NeuralCollaborativeFiltering.jl</title><meta name="title" content="Home · NeuralCollaborativeFiltering.jl"/><meta property="og:title" content="Home · NeuralCollaborativeFiltering.jl"/><meta property="twitter:title" content="Home · NeuralCollaborativeFiltering.jl"/><meta name="description" content="Documentation for NeuralCollaborativeFiltering.jl."/><meta property="og:description" content="Documentation for NeuralCollaborativeFiltering.jl."/><meta property="twitter:description" content="Documentation for NeuralCollaborativeFiltering.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.png" alt="NeuralCollaborativeFiltering.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>NeuralCollaborativeFiltering.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Implemented-recommender-systems"><span>Implemented recommender systems</span></a></li><li><a class="tocitem" href="#Dataset"><span>Dataset</span></a></li><li><a class="tocitem" href="#Model-evaluation"><span>Model evaluation</span></a></li><li><a class="tocitem" href="#Results"><span>Results</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><span class="tocitem">Modules</span><ul><li><a class="tocitem" href="models/">NN Models</a></li><li><a class="tocitem" href="eval/">Model evaluation</a></li><li><a class="tocitem" href="scripts/">Scripts</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/poludmik/NeuralCollaborativeFiltering.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/poludmik/NeuralCollaborativeFiltering.jl/blob/master/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="NeuralCollaborativeFiltering.jl-[![](https://img.shields.io/badge/docs-latest-blue.svg)](https://poludmik.github.io/NeuralCollaborativeFiltering.jl/dev/)-[![License](https://img.shields.io/badge/License-MIT-blue.svg)](https://github.com/JuliaTeachingCTU/ImageInspector.jl/blob/master/LICENSE)-[![Build-Status](https://github.com/poludmik/NeuralCollaborativeFiltering.jl/actions/workflows/CI.yml/badge.svg?branchmaster)](https://github.com/poludmik/NeuralCollaborativeFiltering.jl/actions/workflows/CI.yml?querybranch%3Amaster)"><a class="docs-heading-anchor" href="#NeuralCollaborativeFiltering.jl-[![](https://img.shields.io/badge/docs-latest-blue.svg)](https://poludmik.github.io/NeuralCollaborativeFiltering.jl/dev/)-[![License](https://img.shields.io/badge/License-MIT-blue.svg)](https://github.com/JuliaTeachingCTU/ImageInspector.jl/blob/master/LICENSE)-[![Build-Status](https://github.com/poludmik/NeuralCollaborativeFiltering.jl/actions/workflows/CI.yml/badge.svg?branchmaster)](https://github.com/poludmik/NeuralCollaborativeFiltering.jl/actions/workflows/CI.yml?querybranch%3Amaster)">NeuralCollaborativeFiltering.jl <a href="https://poludmik.github.io/NeuralCollaborativeFiltering.jl/dev/"><img src="https://img.shields.io/badge/docs-latest-blue.svg" alt/></a> <a href="https://github.com/JuliaTeachingCTU/ImageInspector.jl/blob/master/LICENSE"><img src="https://img.shields.io/badge/License-MIT-blue.svg" alt="License"/></a> <a href="https://github.com/poludmik/NeuralCollaborativeFiltering.jl/actions/workflows/CI.yml?query=branch%3Amaster"><img src="https://github.com/poludmik/NeuralCollaborativeFiltering.jl/actions/workflows/CI.yml/badge.svg?branch=master" alt="Build Status"/></a></a><a id="NeuralCollaborativeFiltering.jl-[![](https://img.shields.io/badge/docs-latest-blue.svg)](https://poludmik.github.io/NeuralCollaborativeFiltering.jl/dev/)-[![License](https://img.shields.io/badge/License-MIT-blue.svg)](https://github.com/JuliaTeachingCTU/ImageInspector.jl/blob/master/LICENSE)-[![Build-Status](https://github.com/poludmik/NeuralCollaborativeFiltering.jl/actions/workflows/CI.yml/badge.svg?branchmaster)](https://github.com/poludmik/NeuralCollaborativeFiltering.jl/actions/workflows/CI.yml?querybranch%3Amaster)-1"></a><a class="docs-heading-anchor-permalink" href="#NeuralCollaborativeFiltering.jl-[![](https://img.shields.io/badge/docs-latest-blue.svg)](https://poludmik.github.io/NeuralCollaborativeFiltering.jl/dev/)-[![License](https://img.shields.io/badge/License-MIT-blue.svg)](https://github.com/JuliaTeachingCTU/ImageInspector.jl/blob/master/LICENSE)-[![Build-Status](https://github.com/poludmik/NeuralCollaborativeFiltering.jl/actions/workflows/CI.yml/badge.svg?branchmaster)](https://github.com/poludmik/NeuralCollaborativeFiltering.jl/actions/workflows/CI.yml?querybranch%3Amaster)" title="Permalink"></a></h1><p><img src="assets/dot_mlp_and_both.png" alt="image info"/></p><p>A Julia implementation of three different recommender systems based on the concept of Neural Collaborative Filtering. It utilizes the MovieLens dataset, consisting of users, their movie ratings, movie genres, etc. The goal is to predict how much a certain user will like a particular movie, i.e., <strong>(user, movie) -&gt; rating</strong> prediction.</p><blockquote><p>For a quick start, check out an example of the training process in  <a href="https://github.com/poludmik/NeuralCollaborativeFiltering.jl/blob/master/scripts/testing_package.jl">scripts/testing_package.jl</a>. Activate the environment by running the <code>] activate .</code> command from within the <code>scripts/</code> folder and run the script with <code>include(&quot;testing_package.jl&quot;)</code>.</p></blockquote><h2 id="Implemented-recommender-systems"><a class="docs-heading-anchor" href="#Implemented-recommender-systems">Implemented recommender systems</a><a id="Implemented-recommender-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Implemented-recommender-systems" title="Permalink"></a></h2><p>As for now, 3 models are implemented in this package:</p><table><tr><th style="text-align: right">Model</th><th style="text-align: right">Reference</th><th style="text-align: right">Details</th></tr><tr><td style="text-align: right">Recommender system based on Generalized Matrix Factorization</td><td style="text-align: right">Figure 1 (left) from <a href="https://arxiv.org/pdf/2005.09683.pdf">Neural Collaborative Filtering vs. Matrix Factorization Revisited (2020)</a></td><td style="text-align: right">2 Embedding layers with a dot product</td></tr><tr><td style="text-align: right">Recommender system based on Multi Layer Perceptron</td><td style="text-align: right">Figure 1 (right) from <a href="https://arxiv.org/pdf/2005.09683.pdf">Neural Collaborative Filtering vs. Matrix Factorization Revisited (2020)</a></td><td style="text-align: right">Concatenate 2 Embedding layers and pass the result to the MLP</td></tr><tr><td style="text-align: right">Recommender system based on a combination of Generalized Matrix Factorization and Multi Layer Perceptron similarity</td><td style="text-align: right">Figure 3 from <a href="https://arxiv.org/pdf/1708.05031.pdf">Neural Collaborative Filtering 2017</a></td><td style="text-align: right">Combining both of the above by concatenating their outputs and passing to the NeuMF layer afterwards</td></tr></table><p>All three models utilize Embedding layers that maintain an embedding vector for each user and each movie in the dataset.</p><p>The <code>build_model()</code> function leverages Julia&#39;s multiple dispatch capability, constructing a model object based on the argument types, e.g.:</p><pre><code class="language-julia hljs">m_dot = build_model(DotProductModel, df_train, df_test, embeddings_size=60)
m_both = build_model(GMFAndMLPModel, df_train, df_test, embeddings_size=60, share_embeddings=true)</code></pre><h2 id="Dataset"><a class="docs-heading-anchor" href="#Dataset">Dataset</a><a id="Dataset-1"></a><a class="docs-heading-anchor-permalink" href="#Dataset" title="Permalink"></a></h2><p>I downloaded the MovieLens dataset from <a href="https://grouplens.org/datasets/movielens/#:~:text=recommended%20for%20education%20and%20development">here</a> and stored it in the <code>datasets/</code> folder. Then I wrote an ugly and unoptimized <a href="https://github.com/poludmik/NeuralCollaborativeFiltering.jl/blob/master/scripts/filter_movielens.jl">filter_movielens.jl</a> to extract the data that is actually needed for this project. The main resulting data files (<a href="https://github.com/poludmik/NeuralCollaborativeFiltering.jl/blob/master/datasets/ml-latest-small/user_movie_pairs_for_coll_filtr_train.csv">train CSV file</a> and <a href="https://github.com/poludmik/NeuralCollaborativeFiltering.jl/blob/master/datasets/ml-latest-small/user_movie_pairs_for_coll_filtr_test.csv">test CSV file</a>) are structured in a format compatible for training all three models:</p><table><tr><th style="text-align: right">user</th><th style="text-align: right">movie</th><th style="text-align: right">score</th></tr><tr><td style="text-align: right">159</td><td style="text-align: right">2752</td><td style="text-align: right">0.85</td></tr><tr><td style="text-align: right">610</td><td style="text-align: right">3228</td><td style="text-align: right">0.19</td></tr><tr><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td></tr></table><p>However, this project can easily be extended contain other types of recommender systems, that, e.g. would also consider the features of movies. That&#39;s why I&#39;ve also extracted 20 movie genre features for each of them and divided data to <a href="https://github.com/poludmik/NeuralCollaborativeFiltering.jl/blob/master/datasets/ml-latest-small/movie_genre_df_train.csv">trainset</a> and <a href="https://github.com/poludmik/NeuralCollaborativeFiltering.jl/blob/master/datasets/ml-latest-small/movie_genre_df_test.csv">testset</a> according to the previous &#39;user&#39; x &#39;movie&#39; x &#39;score&#39; split. Features are boolean encoded, each column represents a specified genre.</p><h2 id="Model-evaluation"><a class="docs-heading-anchor" href="#Model-evaluation">Model evaluation</a><a id="Model-evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Model-evaluation" title="Permalink"></a></h2><p>Other than staring at the decreasing test loss during training it is also good to see how the rankings produced by the system effect the order and the accuracy of several recommendations to a single user.</p><blockquote><p><strong>For example</strong>, let&#39;s take the case from the image below: for user number <span>$1$</span>, we have the ground truth order of recommendations with movie ids: <span>$y = [131, 2766, 47, 1517, ...]$</span>. The movie <span>$131$</span> is the most relevant one. The recommender system produces the following order of movie relevances: <span>$\hat y = [131, 2766, 47, 1688, ...]$</span>. We can see that the top 3 reccomendations were predicted right where they should be, which is good. The recommended movie number <span>$1688$</span> isn&#39;t even relevant according to <span>$y$</span>; this is bad. Then, the <span>$1517, 2227$</span> and <span>$2146$</span> are all shifted down by one rank; this is not that bad, but not good. Describing it with &quot;it&#39;s good&quot; or &quot;it&#39;s bad&quot; terms is ok, but we want a numerical evaluation.</p></blockquote><p><img src="assets/eval.png" alt="image info"/></p><p>There are 4 different metrics implemented in <a href="https://github.com/poludmik/NeuralCollaborativeFiltering.jl/blob/master/src/evaluation/metrics.jl">metrics.jl</a>. More specifically:</p><ul><li><p><strong>Accuracy</strong> computes the proportion of elements that match element-wise between the ground truth vector <span>$y$</span> and the predicted vector <span>$\hat y$</span>.</p></li><li><p><strong>Average precision</strong> calculates the average precision of a ranked list of items.</p></li><li><p><strong>Reciprocal rank</strong>, a well-known concept, calculates the inverse relative position of the first true item. Later used in the MRR calculation.</p></li><li><p><strong>Extended Reciprocal rank</strong>, inspired by [3]. Measures the order as well as the relative distance of the rankings.</p></li></ul><p>Then, those functions are utilized by the functions in <a href="https://github.com/poludmik/NeuralCollaborativeFiltering.jl/blob/master/src/evaluation/evaluate_model.jl">evaluate_model.jl</a> to calculate MRR (Mean Reciprocal Rank), MAP (Mean Average Precision), MeanAcc (Mean Accuracy), and MeanExtRR (Mean Extended Reciprocal Rank), which are the same metrics but averaged across all users.</p><h2 id="Results"><a class="docs-heading-anchor" href="#Results">Results</a><a id="Results-1"></a><a class="docs-heading-anchor-permalink" href="#Results" title="Permalink"></a></h2><p>My primary objective for this project was to create a Julia package featuring examples of neural network models from both [1] and [2], which, to my knowledge, don&#39;t yet exist.</p><p>So far, I have not dedicated significant time to optimizing the hyperparameters of the models (such as the sizes of embeddings, learning rates, etc.), resulting in inconsistent performance. However, after running multiple tests to ensure the models&#39; capacity for learning, I&#39;ve empirically observed that the most sophisticated of the three models, the GMFAndMLPModel, tends to outperform the others by a few percentage points. It&#39;s worth noting that these results could improve substantially with more focused efforts on hyperparameter tuning. </p><p>The best results I have achieved are as follows: (<strong>MeanExtRR</strong> = 0.6229, <strong>MRR</strong> = 0.4728, <strong>MAP</strong> = 0.2803, <strong>MeanACC</strong> = 0.0858).</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>[1] <a href="https://arxiv.org/pdf/1708.05031.pdf">Neural Collaborative Filtering (2017)</a></p><p>[2] <a href="https://arxiv.org/pdf/2005.09683.pdf">Neural Collaborative Filtering vs. Matrix Factorization Revisited (2020)</a></p><p>[3] <a href="https://towardsdatascience.com/extended-reciprocal-rank-ranking-evaluation-metric-5929573c778a">Extended Reciprocal Rank</a></p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="models/">NN Models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Wednesday 24 January 2024 18:55">Wednesday 24 January 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
